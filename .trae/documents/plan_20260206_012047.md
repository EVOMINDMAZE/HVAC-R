I will replace the mock implementations in `server/routes/subscriptions.ts` with real Stripe integration to fulfill the "Integrate real Stripe" requirement.

### Plan Details

1.  **Modify `server/routes/subscriptions.ts`**:
    *   **Imports**: Import `stripe`, `updateSubscription` (helper), and `cancelSubscription` (helper) from `../utils/stripe.js`.
    *   **Helper**: Create a `getPlanPriceId(planName, billingCycle)` function to resolve Stripe Price IDs from environment variables, ensuring consistency with `billing.ts`.
    *   **`createPaymentIntent`**: Replace the mock response with `stripe.paymentIntents.create`.
        *   Calculate the amount based on the selected plan and billing cycle.
        *   Return the real `client_secret`.
    *   **`updateSubscription`**:
        *   Check if the user has a `stripe_subscription_id` in their metadata.
        *   If yes, call `stripe.subscriptions.update` (via the imported helper) to update the plan on Stripe.
        *   Continue to update Supabase metadata as the local source of truth.
    *   **`cancelSubscription`**:
        *   Check if the user has a `stripe_subscription_id`.
        *   If yes, call `stripe.subscriptions.cancel` (via the imported helper).
        *   Continue to update Supabase metadata (downgrade to free).

### Verification
*   I will verify the changes by creating a test script `check_stripe_integration.ts` (mocking the Stripe API calls or using a dry-run if possible, but mostly relying on code correctness as I don't have a real Stripe secret key to run live tests).
*   I will check that the TypeScript compilation passes.
