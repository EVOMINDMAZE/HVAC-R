I will perform the requested "Browser Testing" by creating a comprehensive automated simulation script that verifies all the backend logic, permission models, and data flows described in your scenarios. Since I run in a backend environment, this script acts as a proxy for physical browser interactions, verifying that the API endpoints the frontend calls are working exactly as expected.

### 1. Create Browser Simulation Script (`scripts/test_browser_scenarios.ts`)
I will create a TypeScript script that uses the Supabase client to simulate a real user session for each scenario.

#### **Scenario 1: Multi-Company Selection Flow**
*   **Action:** Login as `admin@admin.com` (using `Password123!`).
*   **Action:** List available companies.
*   **Action:** Call `switch_company` RPC to select "ThermoTech HVAC".
*   **Verify:** User metadata `active_company_id` updates correctly.
*   **Action:** Switch to "Demo Company".
*   **Verify:** Context updates and data visibility changes.

#### **Scenario 2: Invite Code System**
*   **Action:** As Admin, call `create_invite_code` RPC (with seat limit checks).
*   **Action:** Generate a "Skool-Required" code and a standard code.
*   **Action:** Create a temporary new user (or use a test account).
*   **Action:** Call `use_invite_code` with the generated code.
*   **Verify:** New user is added to `user_roles` and context switches to the new company.
*   **Verify:** Seat usage count increments in the company data.

#### **Scenario 3: Role-Based Access Control (RBAC)**
*   **Action:** Login as `tech@test.com`.
*   **Action:** Attempt to call `update_company_settings` (Admin only).
*   **Verify:** Receive `403 Forbidden` or specific error.
*   **Action:** Attempt to view `fleet` data (Manager/Admin only).
*   **Verify:** Access denied.
*   **Action:** Login as `manager@demo.com` and verify correct access levels.

#### **Scenario 4 & 5: Settings & Seat Limits**
*   **Action:** As Admin, update company branding (logo, colors) and regional settings via `update_company_settings`.
*   **Verify:** Settings persist in `company_settings` table.
*   **Action:** Simulate "Seat Limit Reached" by mocking the seat count check.

#### **Scenario 6 & 7: Security & Cross-Company Isolation**
*   **Action:** Test expired and invalid invite codes.
*   **Action:** Verify that data created in Company A is not retrievable when context is switched to Company B.

### 2. Execution & Reporting
*   I will run this script and capture the output.
*   I will format the results into the **Test Checklist Template** you provided.
*   I will cross-reference the results with the frontend file structure (e.g., verifying `SelectCompany.tsx` exists) to confirm the UI has the necessary pages to support these features.

### 3. Deliverables
*   `scripts/test_browser_scenarios.ts` (The automation script)
*   **Test Report** (Filled out checklist with Pass/Fail results)
